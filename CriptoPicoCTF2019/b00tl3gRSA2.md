# b00tl3gRSA2

## Objetivos
In RSA d is a lot bigger than e, why don't we use d to encrypt instead of e? Connect with `nc jupiter.challenges.picoctf.org 57464`.


## Solución 
```bash

┌──(kali㉿kali)-[~]
└─$ nc jupiter.challenges.picoctf.org 57464
c: 21603016916789338831743679177951463757709492120657750163983394526656287025481148392183185779678710925125461229989888104590577318218169873339380749328823279043140723815651051161874841025663574542756397211516978322583335530861062409738255604284226167972879309834022149266231661866393131058500482768256108349932
n: 135580488428141778437420858301014615793310663577163014953745131648908906931684370813393337629289573566698567824176435786555354319248188133903247032588234606174715365723939741352979790820813354401449448295326964236665750884434523418300701413839755575927000857492815114707543015399708867228750354143785134054213
e: 109975414877702930279586994022947906916282327170331047727865041098249805338790929588476583126677048549761140508921972724007547425290045031025170701319720927432339371394126815397275895637519753148108799917617435327731609061732529332078257812945708161290287804788623545747586021722433974389718097889263416224513
                                                                                                                    
┌──(kali㉿kali)-[~]
└─$ 


┌──(kali㉿kali)-[~]
└─$ python                  
Python 3.10.7 (main, Sep  8 2022, 14:34:29) [GCC 12.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> c = 21603016916789338831743679177951463757709492120657750163983394526656287025481148392183185779678710925125461229989888104590577318218169873339380749328823279043140723815651051161874841025663574542756397211516978322583335530861062409738255604284226167972879309834022149266231661866393131058500482768256108349932
>>> n = 135580488428141778437420858301014615793310663577163014953745131648908906931684370813393337629289573566698567824176435786555354319248188133903247032588234606174715365723939741352979790820813354401449448295326964236665750884434523418300701413839755575927000857492815114707543015399708867228750354143785134054213
>>> d = 109975414877702930279586994022947906916282327170331047727865041098249805338790929588476583126677048549761140508921972724007547425290045031025170701319720927432339371394126815397275895637519753148108799917617435327731609061732529332078257812945708161290287804788623545747586021722433974389718097889263416224513
>>> e = 65537
>>> m = pow(c, d, n)
>>> m
22191332838283070799487787981341956302723020666194267304787223252675179196935121567817677368697797697342732568002931522598056916054490935081220718198211701712127680755637987422206245172135048625557774756401910572250674821530760042045854972728859652871642867690427132514057843271598362577842882961234739925559
>>> from Crypto.Util.number import long_to_bytes
>>> m = pow(c, e, n)
>>> m
180638594769037903267909311328535969949661653320322151351464061
>>> long_to_bytes(m)
b'picoCTF{bad_1d3a5_2152720}'
>>> 

```

Otra forma de hacerlo con la herramienta rsactftool

```bash
┌──(kali㉿kali)-[/opt/RsaCtfTool]
└─$ python3 RsaCtfTool.py -n 77454978765188068813992978554555928108266211529597287264597073708817431211628060013366452679292901408458193695078273657609898151377603093668547592826477164714787746433994549850306351106767676636129208338145820264580696798544837051974049566399836097605842539013264281070161108650375533491990655626412888485419 -e 31417149099211047702555432029475872208096810978398228288673329728267906280402043415708995095497859196195189938451039086931716779194513374719486712240509055904652541847683628125187837769712379336303150773986132817934789662882184100015652540295499163566689724303496905017651821491996995414117017422651494124553 --uncipher 18821155919212705112168320249045734115664406791077894879178047208097192923089653027590055596232621161416843959930562509291605903539899925160361917345295026471948669080449931548500803790951795797712122939648583821798671956684108625422796827406357838259161849339462325783269388000019724838012129113228132214967 --attack wiener
private argument is not set, the private key will not be displayed, even if recovered.

[*] Testing key /tmp/tmpzkigfymr.
[*] Performing wiener attack on /tmp/tmpzkigfymr.
100%|███████████████████████████████████████████████████████████████████████████| 302/302 [00:00<00:00, 3199.22it/s]
100%|██████████████████████████████████████████████████████████████████████████| 302/302 [00:00<00:00, 89071.08it/s]
[*] Attack success with wiener method !

Results for /tmp/tmpzkigfymr:

Unciphered data :
HEX : 0x7069636f4354467b6261645f31643361355f323135323732307d
INT (big endian) : 180638594769037903267909311328535969949661653320322151351464061
INT (little endian) : 201169787698843420965481973552657641790386789578092809222842736
utf-8 : picoCTF{bad_1d3a5_2152720}
utf-16 : 楰潣呃筆慢彤搱愳張ㄲ㈵㈷細
STR : b'picoCTF{bad_1d3a5_2152720}'
HEX : 0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007069636f4354467b6261645f31643361355f323135323732307d
INT (big endian) : 180638594769037903267909311328535969949661653320322151351464061
INT (little endian) : 87910190142931867941512737591459308787152322034352414891550647016193122744702293089432441900516207136697165114117593033313447779942874804610381382574430813856425123221407441464316774646010836389318800385043642045755626232494835503147470632434581201957777285246336803777952750354626221529133235754522426474496
utf-8 : picoCTF{bad_1d3a5_2152720}
utf-16 : 楰潣呃筆慢彤搱愳張ㄲ㈵㈷細
STR : b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00picoCTF{bad_1d3a5_2152720}'
                                                                                                                    
┌──(kali㉿kali)-[/opt/RsaCtfTool]

```


## Notas adicionales 

https://simple.wikipedia.org/wiki/RSA_algorithm

c - texto cifrado
m - mensaje texto plano
p  - primo 
q  - primo 2
n - modulo 
tn - totient n (euler)
e - exponente (llave publica) 2^16+1 = 65537
d - llave privada 


n = p*q
tn= ( p - q )*  * (q - 1) 
d = e mod inv tn  / inverse (e, tn)

Encriptar : c = m^e mod n / pow(m,e,n) 

Desencriptar : m = c^d mod  n / pow(c,d,n)

en este caso como se cambio e por d la formula queda de esta forma 

pow(c, e,n)

dado que la c es muy pequeña es suseptible al tipo de ataque criptografico llamado  Wiener's attack 