# No Padding, No Problem

## Objetivos

Oracles can be your best friend, they will decrypt anything, except the flag's ciphertext. How will you break it? Connect with `nc mercury.picoctf.net 42248`.

## Solución 
```bash
┌──(kali㉿kali)-[~/Downloads]
└─$ nc mercury.picoctf.net 42248
Welcome to the Padding Oracle Challenge
This oracle will take anything you give it and decrypt using RSA. It will not accept the ciphertext with the secret message... Good Luck!


n: 132625497445561487286853640150081440928302304438998911677136336464246858560414717779002859357208744645269598168447775657595043809245926041107682110539981103707393892649858388592361568114988359029443075183251486384032477178346489522120754098170821012631145323631671092278412132025489504482000499657246134597653
e: 65537
ciphertext: 77538343109170354471616635776664907381524321589007906314379309783852235632743875360240613971200581977068055832262762569954476359108544342572573771915366953080629708486122511142911307837661028969949150302567582800878995455503641863826226649545345317627816426828301657476785152327427562781725152758059485509590


Give me ciphertext to decrypt: 

```

```python
>>> n = 114173143576722470703663290613400734430245124908467938326456171713646272299811234921991840850656049801716572223812829446159146528789560386351778326185477216626742168433925817485210969850143462916845162663009097410581657761444287201287863722704121312071316725517620238518728941465466075574596650426899398842581
>>> e = 65537
>>> c = 38658633413005182597253376615942836253176812848865552264034432662032509379421672021529939028236256837087951104561721005642174878075638780540457710027003935190366005163295313748905433667021813839065940553387789834940559304452082831909688516259000186153671097559543768264876606476731114308036213203566661405364
>>> x = pow(2,e,n)
>>> x
81782588098181626791715365438514415479701197684071643448542392230353666137028048858406434309401066544271206405762050501396764894505457383252482448715028224714338800837090104418805507878586006865944509734696650941527440739410677830594701051098528758395809700112291929053313253462242573035882941224652939743446
>>> c * x
3161603092854404208249355285146688780212787015384973707450475121265871308852260149065246855059662513101005912649366505029486509419873027184254664500943071021191161320550562634193188682845194705313075420650358875309611170968643833790119824599548284720066265510134410864750916225617365243357111431442746916553631288428027791378209012579325815321941549999640316138682350519287020985596268966059274584471165483442673117046308831510163236400535438314076239602803417022498137713863055372432762482848139369183961080767389884159970499277088512138716023789730961519020273262435103791785619119381484811799823995713119968244344
```

```bash

Give me ciphertext to decrypt: 3161603092854404208249355285146688780212787015384973707450475121265871308852260149065246855059662513101005912649366505029486509419873027184254664500943071021191161320550562634193188682845194705313075420650358875309611170968643833790119824599548284720066265510134410864750916225617365243357111431442746916553631288428027791378209012579325815321941549999640316138682350519287020985596268966059274584471165483442673117046308831510163236400535438314076239602803417022498137713863055372432762482848139369183961080767389884159970499277088512138716023789730961519020273262435103791785619119381484811799823995713119968244344
Here you go: 580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890769716268793877259514
Give me ciphertext to decrypt:

```

```shell
>>> m = 580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890769716268793877259514 // 2
>>> from pwn import *
>>> from Crypto.Util.number import long_to_bytes
>>> long_to_bytes(m)
b'picoCTF{m4yb3_Th0se_m3s54g3s_4r3_difurrent_7416022}'
>>> 

```


## Notas adicionales 

https://en.wikipedia.org/wiki/Padding_oracle_attack

https://www.techtarget.com/searchsecurity/definition/homomorphic-encryption

c - texto cifrado
m - mensaje texto plano
p  - primo 
q  - primo 2
n - modulo 
tn - totient n (euler)
e - exponente (llave publica) 2^16+1 = 65537
d - llave privada 


n = p*q
tn= ( p - 1)*  * (q - 1) 
d = e mod inv tn  / inverse (e, tn)

Encriptar : c = m^e mod n / pow(m,e,n) 

Desencriptar : m = c^d mod  n / pow(c,d,n)

Homomorfico:

encriptar(m) * encriptar  (m2) = encripar(m1 * m2)